---
  layout: default
  title: Pilotos inscritos
  section: pilotos
---
<h2>{{ page.title }}</h2>

  <table class="pilots">
    <thead>
      <tr>
        <th width="48%">Nombre</th>
        <th width="40%">Ala</th>
        <th class="glider_class" width="12%">Tipo</th>
      </tr>
    </thead>
    <tbody>
      <tr class="spinner">
        <td colspan="3"><img alt="cargando pilotos..." src="images/ajax-loader.gif"/></td>
      </tr>
    </tbody>
    <tfoot>
      <tr>
        <td colspan="3" class="total">Total: <span id="total_pilots">? alas</span>&nbsp;<span id="total_sport">(? sport)</span></td>
      </tr>
    </tfoot>
  </table>

  <script src="javascript/jquery.min.js" type="text/javascript"></script>
  <script type="text/javascript">
  $(window).load(function(){
    $.ajax({
      url: 'http://morning-planet-6150.herokuapp.com/pilots.json',
      dataType: 'jsonp',
      success: function(pilots) {
        var table = $('table.pilots');
        var tbody = $('tbody', table);
        var tfoot = $('tfoot', table);
        var brands = {};
        var sport = 0;
        tbody.html('');
        for(var i=0;i<pilots.length;i++){
          if(pilots[i].glider_class == 0) sport++;
          
          ( brands[pilots[i].brand]++ || ( brands[pilots[i].brand] = 1) )
          
          tbody.append('<tr class="class_'+pilots[i].glider_class+'">'+
                        '<td>'+pilots[i].name+" "+pilots[i].surname+"</td>"+
                        '<td>'+pilots[i].brand+' '+pilots[i].model+"</td>"+
                        '<td class="glider_class class_'+pilots[i].glider_class+'"><span>&nbsp;</span></td></tr>');
        }
        $('#total_pilots', tfoot).html(pilots.length+ ' alas');
        $('#total_sport', tfoot).html('('+sport+ ' sport)');
        tfoot.show();

        $.each(brands, function(brand, count) {
            tfoot.append('<tr><td colspan="3">'+brand+": <strong>"+count+"</strong></td></tr>");
        });
      }
    });
  });
  </script>
