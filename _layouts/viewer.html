<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="description" content="{{site.description}}">
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0" />
    
    <base href="{{ site.url }}/" /> 
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon"> 
    <title>{{ page.title }} - I {{site.root_desc}}</title>
    <link rel="alternate" type="application/atom+xml" title="Feed del {{site.root_desc}}" href="{{site.url}}/index.xml" />
    <!--[if lt IE 9]><script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
    <link rel="stylesheet" type="text/css" href="styles/viewer.css" />
    <!--[if IE 6]>
      <link rel="stylesheet" type="text/css" href="styles/ie6.css" />
    <![endif]-->
</head>
<body>
  <div class="logo">
    <a href="{{ site.url }}" title="Open de Pedro Bernardo"><img src="images/logo.png"/></a>
  </div>

  {{ content }}

  <div id="map">
  </div>

  <script src="javascript/jquery.min.js" type="text/javascript"></script>
  <script src="javascript/sprintf.js" type="text/javascript"></script>
  <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
  <script type="text/javascript">
    $(window).load(function(){
      var myOptions = {
        mapTypeId: google.maps.MapTypeId.TERRAIN,
        streetViewControl: false,
        scaleControl: false,
   	navigationControl: false
      }
      var map = new google.maps.Map(document.getElementById('map'), myOptions);
      var tracks_base = 'http://clubdevuelopb.com/open/tracks/2012/torneo_puspin/';

      var ctaLayer1 = new google.maps.KmlLayer(tracks_base + '4.kml');
      var ctaLayer2 = new google.maps.KmlLayer(tracks_base + '122.kml');
      var ctaLayer3 = new google.maps.KmlLayer(tracks_base + '121.kml');
      ctaLayer3.setMap(map);
      ctaLayer2.setMap(map);
      ctaLayer1.setMap(map);

      $('#pilot_1').change(function(){
        var color = sprintf("%06x", parseInt($(this).val()) * 41000);
        var kml_color = color.substr(4,2) + color.substr(2,2) + color.substr(0,2);
        $(this).prev('label').css('color', '#' + kml_color);
        ctaLayer1.setMap(null);
        ctaLayer1 = new google.maps.KmlLayer(tracks_base+$(this).val()+'.kml');
        ctaLayer1.setMap(map);
        
      });
      $('#pilot_2').change(function(){
        var color = sprintf("%06x", parseInt($(this).val()) * 41000);
        var kml_color = color.substr(4,2) + color.substr(2,2) + color.substr(0,2);
        $(this).prev('label').css('color', '#' + kml_color);
        ctaLayer2.setMap(null);
        ctaLayer2 = new google.maps.KmlLayer(tracks_base+$(this).val()+'.kml');
        ctaLayer2.setMap(map);
      });
      $('#pilot_3').change(function(){
        var color = sprintf("%06x", parseInt($(this).val()) * 41000);
        var kml_color = color.substr(4,2) + color.substr(2,2) + color.substr(0,2);
        $(this).prev('label').css('color', '#' + kml_color);
        ctaLayer3.setMap(null);
        ctaLayer3 = new google.maps.KmlLayer(tracks_base+$(this).val()+'.kml');
        ctaLayer3.setMap(map);
      });
    });
  </script>
</body>
</html>
